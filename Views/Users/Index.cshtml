@model IEnumerable<CSHarpCHarles2.Models.UsersListItemViewModel>
@{ 
    ViewData["Title"] = "Users";
}

<section class="page-shell">
    <div class="page-header">
        <div>
            <h1 class="page-title">Users</h1>
            <p class="page-subtitle">Create and manage department accounts</p>
        </div>
        <a class="btn btn-primary" asp-action="Create">+ Create Account</a>
    </div>

    @if (TempData["StatusMessage"] is string message && !string.IsNullOrWhiteSpace(message))
    {
        <div class="alert alert-success">@message</div>
    }

    <section class="card">
        <div class="card__header">
            <h2>All Accounts</h2>
        </div>
        <div class="table">
            <div class="table__row table__row--header" style="grid-template-columns: 2fr 2fr 1fr 1fr 1fr 1fr 1fr 1fr;">
                <div>Name</div>
                <div>Email</div>
                <div>Email Confirmed</div>
                <div>Lockout</div>
                <div>Status</div>
                <div>Department</div>
                <div>Roles</div>
                <div></div>
            </div>
            @foreach (var user in Model)
            {
                <div class="table__row" style="grid-template-columns: 2fr 2fr 1fr 1fr 1fr 1fr 1fr 1fr;">
                    <div>@user.DisplayName</div>
                    <div>@user.Email</div>
                    <div>@user.EmailConfirmed</div>
                    <div>@(user.IsLockedOut ? "Locked" : "Active")</div>
                    <div>
                        @switch (user.EmploymentStatus)
                        {
                            case CSHarpCHarles2.Models.EmploymentStatus.Active:
                                <span class="badge badge--success" title="Active">✓</span>
                                break;
                            case CSHarpCHarles2.Models.EmploymentStatus.Resigned:
                                <span class="badge badge--warning" title="Resigned">↗</span>
                                break;
                            case CSHarpCHarles2.Models.EmploymentStatus.LeftWork:
                                <span class="badge badge--danger" title="Left Work">⨯</span>
                                break;
                            case CSHarpCHarles2.Models.EmploymentStatus.DidNotMeetExpectations:
                                <span class="badge badge--neutral" title="Did Not Meet Expectations">!</span>
                                break;
                            default:
                                <span class="badge badge--muted" title="Unknown">?</span>
                                break;
                        }
                    </div>
                    <div>@user.DepartmentDisplay</div>
                    <div>@user.RolesDisplay</div>
                    <div>
                        <a class="icon-btn icon-btn--primary" asp-action="Edit" asp-route-id="@user.Id" title="Edit user">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M12 20h9" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                            </svg>
                            <span class="visually-hidden">Edit</span>
                        </a>
                        <a class="icon-btn icon-btn--neutral" asp-action="ResetPassword" asp-route-id="@user.Id" title="Reset password">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M15 7a4 4 0 0 0-8 0v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                <path d="M7 11h10a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                                <path d="M12 16v2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <span class="visually-hidden">Reset Password</span>
                        </a>
                    </div>
                </div>
            }
        </div>
    </section>
</section>
